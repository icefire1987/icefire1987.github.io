"use strict";(globalThis["webpackChunksound_n_image_board"]=globalThis["webpackChunksound_n_image_board"]||[]).push([[887],{5587:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(2246);class o{constructor(e={}){this.likes=e.likes,this.urls=e.urls}getPath(){return this.urls?.small??""}getLikes(){return this.likes}}const r=o,s=JSON.parse('["cat","dog","chicken","wale","dolphin","car","train","bike","teddy","duck","drum","frog","owl","cow","pig","elephant","sheep","pony","lion","tiger","ball","flowers","apple","banana","bunny","butterfly","chair","shoes","hat","balloon","boat","balloon","sea"]'),i=JSON.parse('{"q":"cat","w":"dog","e":"chicken","r":"wale","t":"dolphin","z":"car","u":"train","i":"bike","o":"teddy","p":"duck","ü":"drum","a":"frog","s":"owl","d":"cow","f":"pig","g":"elephant","h":"sheep","j":"pony","k":"lion","l":"tiger","ö":"ball","ä":"flowers","y":"apple","x":"banana","c":"bunny","v":"butterfly","b":"chair","n":"shoes","m":"hat",",":"balloon",".":"boat","-":"balloon"," ":"sea"}');class l{constructor(){if(l.instance)return l.instance;l.instance=this,this.apiKeyImage="astxCAepblSMvAuAhLX_EKInuPRA_7P_O8tdscx1uQg",this.media={},this.keymap=i,this.unsplash=(0,n.LC)({accessKey:this.apiKeyImage})}async loadMedia(e=0){let t=s.length;e&&(t=e);for(let a=0;a<t;a++){const e=s[a];this.getImagesFromStore(e)||(await this.fetchImages(e),this.storeKeywordAndImage(e,this.media[e]))}}getKeywordFromKey(e){return e?this.keymap[e]:null}getRandomKeyword(){return s[Math.floor(Math.random()*s.length)]}storeKeywordAndImage(e,t){localStorage[e]=JSON.stringify(t)}getImagesFromStore(e){if(localStorage[e])try{return JSON.parse(localStorage[e])}catch{return null}return null}getImageFromStore(e,t){const a=this.getImagesFromStore(e);return Array.isArray(a)?a[t]:null}async fetchImages(e="",t=1){const{response:a={}}=await this.unsplash.search.getPhotos({query:e,page:t,perPage:15}),{results:n=[],total_pages:o}=a;this.media[e]=n.map((e=>{const t=new r(e);return t.getLikes()>6?t:null})).filter((e=>e)),this.getMediaCount(e)<7&&t<o&&this.fetchImages(e,t+1)}getMediaCount(e){return this.media[e]?Object.keys(this.media[e]).length:0}getAudioFile(e){try{const e=Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}());return new Audio(e)}catch(t){return null}}getItem(e){if(console.log(e,":",this.getImagesFromStore(e)),!this.getImagesFromStore(e))return{};const t=this.getRandomNumber(0,this.getMediaCount(e)-1),a=this.getAudioFile(e),n=this.getImageFromStore(e,t);return{image:new r(n),sound:a}}getRandomNumber(e,t){return Math.floor(Math.random()*(t-e+1)+e)}}const d=l},6887:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var n=a(9835),o=a(6970);function r(e,t,a,r,s,i){const l=(0,n.up)("q-spinner-grid"),d=(0,n.up)("q-page-container"),h=(0,n.up)("q-layout");return(0,n.wg)(),(0,n.j4)(h,{view:"lHh Lpr lFf"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"window-height bg-black"},{default:(0,n.w5)((()=>[(0,n._)("div",{class:"flex flex-center full-height",style:(0,o.j5)(e.bgImageStyle)},[(0,n._)("div",null,[e.loading?((0,n.wg)(),(0,n.j4)(l,{key:0,color:"white",size:"xl"})):(0,n.kq)("",!0)])],4)])),_:1})])),_:1})}var s=a(5587);const i=(0,n.aZ)({name:"MainLayout",components:{},data(){return{mediaService:new s.Z,pressedKeyword:null,loading:!1,image:null}},computed:{bgImageStyle(){return{"background-image":`url(${this.image})`,"background-repeat":"no-repeat","background-size":"contain","background-position":"center center"}}},methods:{stopSound(){this.sound&&this.sound.pause()},setSoundAndPlay(e){e&&(this.sound=e,this.sound.play())},getMedia(){if(!this.pressedKeyword)return null;this.stopSound();const{image:e,sound:t}=this.mediaService.getItem(this.pressedKeyword);return e&&(console.log(e),this.image=e.getPath()),this.setSoundAndPlay(t),!0},keylistener(e){const{key:t}=e;this.pressedKeyword=this.mediaService.getKeywordFromKey(t)},getRandomKeyword(){this.pressedKeyword=this.mediaService.getRandomKeyword()},async fetchData(){try{this.loading=!0,console.log("load"),await this.mediaService.loadMedia()}catch(e){console.error(e)}finally{this.loading=!1,console.log("done")}}},created(){window.addEventListener("keydown",this.keylistener),window.addEventListener("click",this.getRandomKeyword),window.addEventListener("touchstart",(e=>{e.preventDefault()})),window.addEventListener("touchmove",(e=>{e.preventDefault()}))},mounted(){this.fetchData()},watch:{pressedKeyword(){this.getMedia()}}});var l=a(1639),d=a(2500),h=a(2133),u=a(3040),c=a(9984),g=a.n(c);const m=(0,l.Z)(i,[["render",r]]),p=m;g()(i,"components",{QLayout:d.Z,QPageContainer:h.Z,QSpinnerGrid:u.Z})}}]);